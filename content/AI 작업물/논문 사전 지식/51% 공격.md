# 51% 공격 (51% Attack)

## 정의

51% 공격은 [[블록체인]] 네트워크에서 단일 엔티티가 **전체 해시파워(또는 지분)의 과반을 확보**하여 네트워크를 조작하는 공격이다. Majority Attack이라고도 불린다.

## 공격 원리

### PoW 기반 블록체인에서

1. 공격자가 네트워크 해시파워의 51% 이상 확보
2. 비밀리에 대안 체인(alternative chain) 채굴 시작
3. 거래소에 암호화폐 입금 후 법정화폐로 환전
4. 원본 체인보다 긴 대안 체인 공개
5. 최장 체인 규칙에 의해 대안 체인이 정식 체인으로 인정
6. 원래 입금 거래가 무효화됨 → **Double Spending** 성공

```
정상 체인:    A ─ B ─ C ─ D ─ E
                      ↑ (입금 거래 포함)
                      
공격자 체인:  A ─ B ─ C' ─ D' ─ E' ─ F'
                      ↑ (입금 거래 없음)
                      
→ 공격자 체인이 더 길면 정식 체인으로 교체됨
```

## 공격 가능 행위

| 행위 | 가능 여부 |
|------|----------|
| Double Spending (이중 지출) | ✅ 가능 |
| 거래 취소/되돌리기 | ✅ 가능 |
| 블록 재정렬 | ✅ 가능 |
| 새 코인 무한 생성 | ❌ 불가능 |
| 다른 사람의 코인 탈취 | ❌ 불가능 |
| 프로토콜 규칙 변경 | ❌ 불가능 |

## 실제 사례

| 암호화폐 | 시기 | 피해 |
|---------|------|------|
| Bitcoin Gold (BTG) | 2018.05 | $18M |
| Ethereum Classic (ETC) | 2019.01 | $1.1M |
| Ethereum Classic (ETC) | 2020.08 | $5.6M (3회 연속) |
| Bitcoin SV (BSV) | 2021.08 | 재정렬 발생 |

## 방어 방법

### 1. 네트워크 해시레이트 증가
- 공격 비용 상승 → 경제적 비효율

### 2. 확인 횟수 증가
- 거래소에서 입금 확인에 더 많은 블록 요구
- Bitcoin: 보통 6 확인, 고액은 더 많이

### 3. 합의 알고리즘 변경
- PoW → PoS 전환
- 하이브리드 합의 메커니즘

### 4. 체크포인트
- 특정 블록을 확정(finalized)으로 지정
- 그 이전 블록 재정렬 불가

### 5. 지연된 작업 증명 (dPoW)
- 보조 체인에 해시 기록
- 메인 체인 보안 활용

## 공격 비용 추정

[Crypto51.app](https://www.crypto51.app/) 등에서 각 암호화폐의 51% 공격 비용(시간당) 추정 가능.

- Bitcoin: 수십억 원/시간 (사실상 불가능)
- 소규모 PoW 코인: 수십만 원/시간 (위험)

## 관련 개념

- [[블록체인]]
- [[합의 알고리즘]]
- [[암호화폐]]
- [[이클립스 공격]]
- [[시빌 공격]]
- Double Spending
