# 이종 그래프 신경망 (Heterogeneous Graph Neural Network)

## 정의

이종 그래프 신경망은 **여러 유형의 노드와 엣지를 가진 그래프**를 처리하는 [[그래프 신경망]]이다. 일반 GNN이 동일한 유형의 노드만 다룬다면, 이종 GNN은 서로 다른 유형의 개체와 관계를 함께 모델링한다.

## 동종 vs 이종 그래프

| 구분 | 동종 그래프 | 이종 그래프 |
|------|------------|------------|
| 노드 타입 | 1개 | 여러 개 |
| 엣지 타입 | 1개 | 여러 개 |
| 예시 | 소셜 네트워크 (사용자-사용자) | 지식 그래프 (사람-영화-장르) |

## 예시: 소프트웨어 보안 그래프

```
[소프트웨어 컴포넌트] --의존-- [라이브러리]
        |                        |
      연관됨                   영향받음
        |                        |
      [CWE] <--------원인------- [CVE]
```

노드 타입: 컴포넌트, 라이브러리, CVE, CWE
엣지 타입: 의존, 연관, 영향, 원인

## 대표 모델

### HAN (Heterogeneous Graph Attention Network)
- 메타패스 기반 어텐션 사용
- 동일 메타패스의 이웃에 주의 집중

### HGAT (Heterogeneous Graph Attention Network)
- 노드 타입별로 다른 변환 행렬 적용
- 엣지 타입별 어텐션 가중치 학습
- 다양한 관계를 자연스럽게 모델링

### HGT (Heterogeneous Graph Transformer)
- 트랜스포머 구조 활용
- 대규모 이종 그래프에 효과적

## 작동 원리 (HGAT)

```python
# 1. 노드 타입별 임베딩
h_software = W_software @ x_software
h_cve = W_cve @ x_cve

# 2. 엣지 타입별 어텐션
attention = softmax(LeakyReLU(a^T [h_i || h_j]))

# 3. 이웃 정보 집계
h_new = Σ attention * h_neighbor
```

## 활용 분야

1. **소프트웨어 보안**: [[SBOM]] 기반 취약점 예측
2. **추천 시스템**: 사용자-아이템-속성 관계
3. **[[지식 그래프]]**: 다양한 엔티티 간 추론
4. **생물정보학**: 유전자-질병-약물 네트워크

## 장점

- 다양한 관계의 의미를 보존
- 실세계의 복잡한 시스템을 자연스럽게 표현
- 노드 타입별 특성 학습 가능

## 관련 개념

- [[그래프 신경망]]
- [[딥러닝]]
- [[지식 그래프]]
- [[CVE]] - 보안 분석에서 노드로 사용
- [[SBOM]] - 소프트웨어 의존성 그래프
