
<aside>
💡 네트워크 코어 영역에서는 **라우터**가 핵심이며 라우터의 동작 방식을 이해하기 위해 **패킷 스위칭(Packet Switching)**을 알아볼 것이며 **회선 스위칭(Circuit Switching)**과의 차이점을 비교해보면 더욱 쉽게 이해할 수 있기에 이 또한 알아볼 것이다라고 하셨다.

</aside>
---

**Core Network 정의**

- 접속 네트워크들을 연결하기 위해 ISP들이 운영하는 광역 네트워크

**구성**

- 라우터들을 고속의 링크로 연결

**종단간(End-to-end) 경로**

- N개의 링크와 (N - 1)개의 라우터의 연결

말이 어렵개 쓰여 있는 것 같다만 설명을 이해한 바로는 연결의 끝과 끝에 있는 종단 장치
(노트북 - 서버)를 이어주는 링크와 라우터가 있을 때 라우터가 1개 있던 2개 있던 링크가 1개 더 많을 수 밖에 없다는 어찌보면 당연한 말인 것 같다.

그리고 이 처럼 연결된 무수히 많은 라우터 장치와 링크가 인터넷의 코어부분을 구성하고 있다고 하셨다.

---

**라우터(Router)**

라우터가 하는 일은 2가지다.

- 네트워크를 대상으로한 연결 기능
- 수신된 패킷을 대상으로한 교환 기능

---

**패킷 스위칭(Packet Switching)**

**패킷(Packet)**

**정의**

- 전송 장치 간에 전달되는 정보 단위
- 공유 링크의 공정한 전송을 위해 긴 메시지를 작은 패킷 단위로 나누어 전송

**여기서 공정한 전송이란?**

<aside>
💡 어떤 서비스를 이용할 때 전송 되는 데이터의 양은 각기 다를 것이다. (그림, 동영상 등)

누군가 수십 GB의 동영상을 보낼 때 이 자체를 라우터에 보내게 된다면 시간이 오래 걸릴 것이고 그 시간 만큼 다른 사용자는 작은 데이터를 보낼지라도 오랜 시간 동안 기다려야 한다.
이를 방지하기 위해 작은 패킷 단위로 나누어 신속하게 전송하는 것이다.

</aside>

**패킷 스위치(Packet Switch)**

**정의**

- 입력 링크와 출령 링크 간에 패킷 단위 교환
- L2(링크 계층) 스위치, 라우터

---

**라우터의 저장-전달(Store-and-Forward) 전송**

- 수신 패킷을 버퍼 메모리에 저장
- 패킷을 완전히 수신 후 패킷 전송 시작
- 출발지와 각 라우터에서 전송지연시간 발생

수신된 패킷을 받자마자 보내는 것이 아닌 모든 패킷을 전부 수신한 뒤에 해석을 하는 과정을 거치고 가장 적합한 링크로 보낸다고 하셨다. (라우터는 굉장히 바쁜 장비겠구나라는 생각이 들었다.)

그리고 이런 저장 - 전달 과정을 거치기 때문에 출발지와 각 라우터 마다에서 전송지연시간이 발생할 수 밖에 없다고 하셨다.

패킷의 총 크기(L 비트)와 링크 전송속도(R bps), 링크 개수(N)이 있다면

N * (L/R) 이라는 공식으로

**종단간 패킷 전송 지연시간**을 구할 수 있다고 하셨다. ~~아마 내가 쓸데는 없을 것 같다.~~

---

**큐잉 지연시간(Queuing delay)**

- 패킷이 패킷 스위치(라우터)의 출력 링크의 큐 버퍼 메모리에서 전송전에 대기하는 시간
- 출력 링크의 전송속도보다 많은 양의 패킷이 해당 링크로 교환될 때 발생

![Untitled](images/Network/Untitled%2010.png)

위 사진은 라우터의 구조를 나타낸 것이다.

라우터에 링크로 연결된 모든 장치들은 각 링크 마다 담당NIC(Network Interface Card)가 있다. 라우터는 패킷을 읽고 수신된 Interface에서 송신될 Interface로 교환하는 역할을 하는 것이다. 이 NIC의 메모리를 버퍼 메모리라고 부르며 이 메모리의 자료구조 FIFO Queue다.

이때 하나의 Interface로 트래픽이 몰린다고 가정해보자.

여러 Interface에서 라우터로 수신 되는 패킷들이 하나의 Interface로 향할 때, 송신하는 곳으로 연결된 링크의 **처리 가능한 전송속도 보다** **교환 해야할 패킷의 양이 더 많다면** 버퍼 메모리의 자료구조인 FIFO Queue 방식에 따라 당연히 지연 시간이 발생하고 이를 **큐잉 지연시간**이라고 부르는 것이다.

데이터센터와 가까운 곳에 살고 있다면 더 빠른 티켓팅이 가능한 것일까? 하는 궁금증이 생겼다.

---

**패킷 손실(Packet loss)**

- 버퍼 메모리에서 패킷이 저장되지 못하고 없어지는 현상
- 유한한 크기의 버퍼 메모리에서 저장될 수 없을 만큼 많은 양의 패킷이 해당 링크로 교환될 때 발생

![Untitled](images/Network/Untitled%2011.png)

큐잉 지연시간은 버퍼 메모리로 인해 발생되는 것이고 **메모리기에 크기는 한정적**일 것이다. 만약 버퍼 메모리의 크기가 40개의 패킷을 저장할 수 있는 정도라고 할 때 50개의 패킷이 들어왔다면 40개는 저장 되고 10개의 패킷은 버려지는 현상을 **패킷 손실**이라고한다.

---

**라우팅 테이블과 라우팅 프로토콜**

**라우팅 테이블(Routing table)**

- 입력 패킷에 대한 교환 규칙을 정의하는 자료구조
- 패킷 전달 테이블(Forwarding table)

라우터의 출력 링크가 여러개 있을 경우 어느 링크로 교환을 할 것인지 규칙이 정의된 테이블을 **라우팅 테이블** 혹은 **패킷 전달 테이블**이라고 한다. (목적지가 어디인 경우 어떤 링크로 보내라와 같은 규칙)

**라우팅 프로토콜(Routing protocol)**

- 라우팅 테이블을 자동으로 생성하는 프로토콜

이에 대한 자세한 설명은 추후에 한다고 하셨다.

---

**회선 스위칭(Circuit switching)**

- 스위치의 입력 포트에 연결된 회선(링크)을 출력 포트에 연결된 동일 전송속도의 회선으로 교환
- 회선 교환 작업을 일련의 스위치에서 반복하여 종단 장치를 일정 전송속도의 전용 회선으로 연결
- No sharing link
- No store-and-forward
- No queuing delay

그냥 종단 간의 연결을 하나의 링크로 연결된 것 처럼 구현하여 링크를 공유하지도 저장 했다가 전달할 필요도 큐잉 지연도 없는 스위칭이라고 생각하면 되겠다.

**회선 스위칭의 특징과 응용**

- 일정한 전송 속도 보장
- 짧고 일정한 지연 시간이 보장
- 전화와 같이 연속적인 신호 전송과 실시간을 요하는 응용에 적합

**회선 스위칭의 문제점**

- 데이터가 발생되지 않는 구간에서는 회선이 낭비

(각 자동차 마다 전용 도로가 있는데 차가 늘어날 수록 도로를 확장해야 되고 도로가 늘어날 수록 최대 속력이 낮아지는 느낌으로 생각하면 될 것 같다. 덫 붙이자면 도로를 개통 해놓고 쓰지도 않으면 손해인게 단점이다.)

![Untitled](images/Network/Untitled%2012.png)

정리 하자면 위 같은 이유로 인터넷은 회선 스위칭 보단 패킷 스위칭이 더 유리하다고 볼 수 있는 것이다.

---

**상위 ISP 네트워크들의 네트워크**

- 고속의 링크들이 패킷 스위치인 라우터들로 그물망 처럼 연결된 네트워크(Mesh of Routers)