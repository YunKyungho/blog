이용자가 무언가 할 일들을 입력하고 그것을 표기하고 저장하며 나중에 들어와도 삭제하지 않는 이상 남아있게 하는 것을 배울 것이다. DB 없이 말이다. (미니 게시판 느낌이라 생각하면 좋을 것 같다.)

**리스트 생성**

---

일단 당연히 form과 input, to do list(li)를 넣을 ul이 필요하다.

![Untitled](images/JavaScript/Untitled%204.png)

id를 주고 js에서 값을 불러준 다음

![Untitled](images/JavaScript/Untitled%205.png)

위의 form에서 submit event가 발생할 경우 toDoFormSubmitEvent 함수를 불러준다.

submit의 기본 행동을 막은 다음 input에 적혔던 값을 변수에 저장하고 input을 비워준다.

그리고 이 입력한 값을 to do list로 보내주기 위해 li와 span 객체를 만들고 li - span - innerText 순으로 값을 담아주는 함수를 호출한다.(input에 적은 text를 사용)

![Untitled](images/JavaScript/Untitled%206.png)

그러면 이렇게 일단 input에 적은 내용을 리스트로 만드는 것 까진 가능하다.

이제 이 리스트를 삭제하는 기능과 저장해놨다가 새로고침 해도 다시 불러오는 기능이 필요하다.

우선 삭제 먼저 알아보자.

**리스트 삭제**

---

버튼을 누르면 리스트가 사라지게 만들 것인데 기본 버튼이 이쁘진 않다만 일단 해보자.

우선 리스트를 삭제할 버튼이 필요하기에 위의 입력한 값을 토대로 리스트를 만들어주는 updateTodo 함수에서 버튼도 같이 만들어 보내자.

![Untitled](images/JavaScript/Untitled%207.png)

동일한 방법으로 버튼을 생성하고 안의 텍스트는 마음대로 지정한다. 나는 완료로 할 것이다.

그리고 li에 생성한 객체를 보내줘야 하는데 순서상 <할 일 내용>이 나오고 옆에 <삭제버튼>이 나오는 것이 자연스럽기에 span을 먼저 appendChild 해주고 후에 button을 추가 해준다.

![Untitled](images/JavaScript/Untitled%208.png)

이렇게 나오게 말이다.

그럼 다음 해야할 일은 눈에 선하다. 완료 버튼 누르는 이벤트를 감지하면 이 리스트를 삭제하는 함수를 실행해주면 될 것이다.

![Untitled](images/JavaScript/Untitled%209.png)

버튼의 이벤트 리스너는 버튼을 만들 때(함수에서) 넣어주어야 한다.

다만 이렇게 버튼의 이벤트를 넣어줄 경우 여러 리스트가 있을 때 어떤 버튼에서 발생한 이벤트인지 알 수가 없다. 그래서 필요한 것이 target이다. 어디서 이벤트가 발생 되었는지 알려준다.

그런데 우리가 삭제 해야할 것은 이 버튼이 아닌 버튼의 상위 객체인 li다. 그리고 그건 parentElement로 지정이 가능하다.

![Untitled](images/JavaScript/Untitled%2010.png)

위의 말한 방법대로 값을 찾아 변수에 담아주고 remove() 를 통해 지워준다.

리스트를 만들고 삭제하는 것 까진 완료 했지만 여전히 새로고침을 하면 모든 리스트가 날아가 버린다. 이제 이 리스트를 local storage에 저장하고 불러오고 리스트를 삭제하면 데이터 또한 삭제하는 방법을 알아야한다.

**리스트 저장**

---

단순히 배열을 만들고 그 배열을 localStorage에 등록하는 방법으로는 문제를 해결할 수 없다.

![Untitled](images/JavaScript/Untitled%2011.png)

![Untitled](images/JavaScript/Untitled%2012.png)

배열을 저장 해도 localStorage에선 단순히 텍스트로 저장될 뿐이고 또 새로고침 후에 데이터가 남아있긴 하지만 새로운 toDoList를 적는 순간 기존에 있던 List는 사라지고 새로 입력한 값만 저장 된다.

![Untitled](images/JavaScript/Untitled%2013.png)

![Untitled](images/JavaScript/Untitled%2014.png)

이런식으로 그저 텍스트로만 저장이 되는 것을 진짜 배열 형식으로 저장을 하려고 한다.

그때 필요한 것이

![Untitled](Untitled%2015.png)

JSON.stringify다. 이는 JavaScript 객체, 배열 또는 어떤 Js의 코드건 간에 그걸 String으로 만들어준다.

![Untitled](images/JavaScript/Untitled%2016.png)

이렇게 말이다.

**리스트 불러오기**

---

![Untitled](images/JavaScript/Untitled%2017.png)

위에서 배열모양의  String을 로컬스토리지에 저장 했는데 이걸 그냥 불러오면 단순히 괄호가 쳐진 String으로 불러오게 된다. 그렇기에 JSON.parse를 이용하는데

![Untitled](images/JavaScript/Untitled%2018.png)

이렇게 간편하게 배열로 다시 바꿔준다.

![Untitled](images/JavaScript/Untitled%2019.png)

먼저 웹사이트가 실행 되면 localStorage에 있는 toDos 아이템을 가져온 다음 null이 아니라면 가져온 아이템을 배열로 파싱한 뒤에 이 배열로 반복문을 돌려줄 것인데 위 처럼 아이템.forEach(함수)라는 문법으로 함수를 부르게 될 경우 JavaScript가 알아서 parsedToDos 배열에 있는 아이템을 함수에 넣어준다.

<aside>
💡 위 방식 처럼 함수를 다른 곳에 작성하고 반복문안에 함수를 불러올 수도 있지만 function을 따로 작성하지 않고 forEach 옆에 바로 적어서 함수를 실행 시킬 수도 있다. (우리가 jQuery나 Python에서 봐왔던 것 처럼 말이다.)
parsedToDos.forEach((item) => console.log(item))
이런식으로 말이다.

</aside>

그리고 우리에겐 전에 만든 리스트를 만들어주는 함수가 있다.

![Untitled](images/JavaScript/Untitled%2020.png)

updateToDo는 그저 String만 넣어주면 toDoList를 만들어주는 함수이기에 forEach가 배열의 아이템을 순서대로 넣어 주기만 하면 기존에 작성한 toDoList를 다시 만들어줄 것이다.

그래도 새로운 리스트를 적으면 기존에 있던 리스트를 덮어 씌우는 현상은 여전한데 그 이유는 우리가 사이트에 접속할 때 마다 

![Untitled](images/JavaScript/Untitled%2021.png)

이 toDos 배열은 항상 비어있기 때문이다. 그래서 빈 배열에 새롭게 입력한 값만 로컬스토리지에 저장 되는 것이다.

그렇기에 저 const를 let으로 바꿔 값 변경이 가능하게 해주고

![Untitled](images/JavaScript/Untitled%2022.png)

위의 작업에서 toDos의 값을 로컬스트리지에 있는 값으로 배열을 만든 parsedToDos를 담아주는 것이다.

하지만 화면에 나온 리스트를 삭제 해도 로컬 스트리지에서는 삭제가 되지 않아 계속 해서 남아있기에 이 부분을 고쳐줘야 한다.

**로컬스트리지 리스트 삭제**

---

기존 deleteToDo function은 브라우저에 있는 어떤 리스트를 지워야 하는지는 알고 있지만 로컬스트리지에 어떤 text를 지워야 하는지는 모르고 있다.

![Untitled](images/JavaScript/Untitled%2023.png)

그래서 이런식으로 input에 입력한 값은 text로 Date.now() (밀리초로 주어지기에 id로 이용)는 id로 객체를 만들어 이 객체를 toDos 배열에 넣어줄 것이다.

또한  텍스트만으로 리스트를 만들던 updateToDo에도 이 객체를 넣어줄 것이다.

![Untitled](images/JavaScript/Untitled%2024.png)

그렇기에 이렇게 객체의 text 키를 가진 것을 리스트 텍스트로 쓰게끔 바꿔주고

![Untitled](images/JavaScript/Untitled%2025.png)

Html 객체 자체에게도 이 id 값을 기억할 수 있게끔 li의 id에는 객체의 id 값을 넣어준다.

이제 배열에 적용할 수 있는 filter라는 함수를 이해해야 한다.

<aside>
💡 filter는 배열.filter(함수) 
이런 문법을 갖고 있으며 배열의 값들을 순서대로 아이템으로 이용하여 함수를 작동 시키는데 함수에서 true를 return 하면 앞의 배열에서 살아남고 false를 return하면 배열에서 제외 된다. 그렇게 모든 아이템들을 true, false 과정을 거친 뒤 살아남은 아이템들로만 다시 배열을 생성 해주는 기능이다.

</aside>

위 filter를 이해 했다면 리스트를 삭제하는 것은 아주 간단하다.

![Untitled](images/JavaScript/Untitled%2026.png)

그저 toDos의 배열을 filter를 적용한 배열로 바꿔주기만 하면 된다.

그 필터의 내용은 toDos 배열에 있던 객체의 id라는 “키”의 값이 현재 이 li의 id의 값과 같지 않다. 인데

(위의 filter에 대한 설명 대로라면 이 id가 같지 않다면 true가 return되어 배열에 남아있을 것이고 id가 같다면 false가 return 되기에 배열에서 제외될 것이다.)

하지만 객체에 저장된 id는 number고 li에 저장된 id는 String이라서

![Untitled](images/JavaScript/Untitled%2027.png)

parseInt 정도는 해줘야 함수가 의도한대로 작동한다.

![Untitled](images/JavaScript/Untitled%2028.png)

마지막으로 로컬스트리지에 이 새롭게 만든 toDos를 저장해주는 것 까지 하면 끝이다.